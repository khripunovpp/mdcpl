<script>
  window.loadLazy = function () {
    $(function () {
      var lazy = $('.lazy').Lazy({
        effect: 'fadeIn',
        effectTime: 500,
        threshold: 0,
        afterLoad: function (element) {
          $(element).closest('.lazy-wrapper').addClass('is-loaded');
        },
      });
    })
  }
  window.isMobile = function () {
    return window.matchMedia("only screen and (max-width: 990px)").matches;
  };
  window.initMap = function () {
    console.log('initMap');
    var map = new google.maps.Map(document.getElementById('callback-widget-map'), {
      center: {lat: 38.7223, lng: -9.1393}, // Координаты Лиссабона
      zoom: 12, // Масштаб карты
      disableDefaultUI: true, // Отключить все контролы
    });


    // Создайте маркеры для Лиссабона и Порту.
    var lisbonMarker = new google.maps.Marker({
      position: {lat: 38.7223, lng: -9.1393}, // Координаты Лиссабона
      map: map,
      title: 'Лиссабон',
    });

    var portoMarker = new google.maps.Marker({
      position: {lat: 41.1579, lng: -8.6291}, // Координаты Порту
      map: map,
      title: 'Порту',
    });

    var oeiras = new google.maps.Marker({
      position: {lat: 38.6886, lng: -9.3103}, // Координаты Oeiras
      map: map,
      title: 'Оейраш',
    });

  };

  window.appointmentsUrl = 'https://rubitime.ru/api/get-project-static/f7fbb1acc92982eb871f4d96d6672d3bb17163bd2ec3ecc7aa280b4808f8d480';

  window.insertSprites = function () {
    if (!window.cachedSvg$) {
      var sprite$ = $('.sprite').find('svg');
      // replace all symbol tag with svg tag, clone is wrong
      var spriteSvg = sprite$[0].outerHTML.replace(/symbol/g, 'svg');
      console.log({
        spriteSvg: spriteSvg,
      });
      // jquery fragment
      window.cachedSvg$ = $(spriteSvg).clone().html('');

      $(spriteSvg).children().each(function (index, element) {
        var $element = $(element);
        var id = $element.attr('id');
        var xmlns = $element.attr('xmlns');
        var viewBox = $element.attr('viewBox');

        var width = viewBox.split(' ')[2];
        var height = viewBox.split(' ')[3];
        var svg$ = $('<svg xmlns="' + xmlns + '" viewBox="' + viewBox + '"  width="' + width + '"  height="' + height + '"  id="' + id + '"></svg>');
        svg$.html($element.html());
        console.log({svg$: svg$[0].outerHTML, id})
        window.cachedSvg$.append(svg$);
      })
      console.log('!!!!!!!!!!!!')
      console.log({cachedSvg$})
    }


    // find all classes contains paste-sprite
    var pasteSprite$ = $('[class*="paste-sprite"]');

    pasteSprite$.each(function (index, element) {
      var $element = $(element);
      if ($element.hasClass('inserted')) return;
      var className = $element.attr('class');
      var spriteClass = className.match(/paste-sprite-([^\s]+)/)[1];
      var iconSvg$ = window.cachedSvg$.find('#' + spriteClass);
      if (!iconSvg$.length) return;
      $element.html(iconSvg$[0].outerHTML);
      $element.addClass('inserted')
    });
  }

  $(function () {
    window.insertSprites();
  })
</script>